#!/bin/bash

# –°–∫—Ä–∏–ø—Ç –¥–ª—è —à–≤–∏–¥–∫–æ–≥–æ –≤—Ö–æ–¥—É –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Odoo

# –û—Ç—Ä–∏–º—É—î–º–æ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é —Å–∫—Ä–∏–ø—Ç–∞
SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
PROJECT_DIR="$(cd "${SCRIPT_DIR}/.." && pwd)"

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º–æ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –ø—Ä–æ–µ–∫—Ç—É
cd "${PROJECT_DIR}"

# –ü–µ—Ä–µ–≤—ñ—Ä—è—î–º–æ, —á–∏ –∑–∞–ø—É—â–µ–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
if ! docker compose ps | grep -q "web.*Up"; then
    echo "‚ùå –ü–æ–º–∏–ª–∫–∞: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä Odoo –Ω–µ –∑–∞–ø—É—â–µ–Ω–∏–π!"
    echo "   –ó–∞–ø—É—Å—Ç—ñ—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏: docker compose up -d"
    exit 1
fi

echo "üêö –í—Ö—ñ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä Odoo..."
echo "   –í–∏–∫–æ—Ä–∏—Å—Ç–∞–π—Ç–µ 'exit' –¥–ª—è –≤–∏—Ö–æ–¥—É"
echo ""

# –í—Ö–æ–¥–∏–º–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑ bash, —è–∫—â–æ –¥–æ—Å—Ç—É–ø–Ω–∏–π, —ñ–Ω–∞–∫—à–µ sh
docker compose exec web bash || docker compose exec web sh
